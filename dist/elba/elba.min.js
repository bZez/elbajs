/*! elba - v0.0.1 - 2014-09-30
* https://github.com/dedalodesign/elbajs
* Copyright (c) 2014 ; Licensed  */
!function(a){"use strict";function b(a){return new RegExp("(^|\\s+)"+a+"(\\s+|$)")}function c(a,b){var c=d(a,b)?f:e;c(a,b)}var d,e,f;"classList"in document.documentElement?(d=function(a,b){return a.classList.contains(b)},e=function(a,b){a.classList.add(b)},f=function(a,b){a.classList.remove(b)}):(d=function(a,c){return b(c).test(a.className)},e=function(a,b){d(a,b)||(a.className=a.className+" "+b)},f=function(a,c){a.className=a.className.replace(b(c)," ")});var g={hasClass:d,addClass:e,removeClass:f,toggleClass:c,has:d,add:e,remove:f,toggle:c};"function"==typeof define&&define.amd?define(g):"object"==typeof exports?module.exports=g:a.classie=g}(window),function(a){"use strict";HTMLElement.prototype.wrap=function(a){a.length||(a=[a]);for(var b=a.length-1;b>=0;b--){var c=b>0?this.cloneNode(!0):this,d=a[b],e=d.parentNode,f=d.nextSibling;c.appendChild(d),f?e.insertBefore(c,f):e.appendChild(c)}},Element.prototype.remove=function(){this.parentElement.removeChild(this)},NodeList.prototype.remove=a.HTMLCollection.prototype.remove=function(){for(var a=0,b=this.length;b>a;a++)this[a]&&this[a].parentElement&&this[a].parentElement.removeChild(this[a])}}(window),function(){"use strict";Function.prototype.setScope=function(a){var b=this;return function(){b.apply(a)}}}(),function(a){"use strict";"function"==typeof define&&define.amd?define(a):window.Elba=a()}(function(){"use strict";function a(a,b){function c(a,b){return m.has(a,b)}function d(a){var b=this,e=a||b.loaderPointer,f=b.slides[e],g=b.slides.length;c(f,b.options.successClass)&&g>1&&g-1>e+1&&(e++,console.log("recursively fired"),d.call(b,e));var h=f.getAttribute(b.source||b.options.src),i=f.querySelector(".elba-island");if(h){var j=h.split(b.options.separator),k=j[n&&j.length>1?1:0],l=new Image;l.onerror=function(){b.options.error&&b.options.error(f,"invalid"),f.className=f.className+" "+b.options.errorClass},l.onload=function(){if(i.src=k,b.setImageSize(i),m.add(f,"no-bg-img"),m.add(f,b.options.successClass),b.options.success&&b.options.success(f),g>1&&(1===e||0===e||e===g-1||e===g-2)){var a,h;a=1===e?b.slides[g-1]:e===g-1?b.slides[1]:0===e?b.slides[g-2]:b.slides[0],c(a,b.options.successClass)||(h=a.querySelector(".elba-island"),h.src=k,b.setImageSize(h),m.add(a,"no-bg-img"),m.add(a,b.options.successClass))}g>1&&g-1>e+1&&(e++,console.log("recursively fired"),d.call(b,e))},l.src=k}else b.options.error&&b.options.error(f,"missing"),f.className=f.className+" "+b.options.errorClass}function g(){function a(){h.call(b),b._resizeTimeout=null}var b=this;b._resizeTimeout&&clearTimeout(b._resizeTimeout),b._resizeTimeout=setTimeout(a,100)}function h(){var a=this;a.setSlidesWidth(),a.goTo();var b=a.source;if(a.setSource(),b!==a.source)i.call(a),d.call(a);else for(var c=0;c<a.slides.length;c++){var e=a.slides[c];if(e){var f=e.querySelector(".elba-island");a.setImageSize(f)}}}function i(){var a=this,b=a.slides.length;a.loaderPointer=b>1?1:0;for(var c=0;b>c;c++){var d=a.slides[c];d&&(m.remove(d,"no-bg-img"),m.remove(d,a.options.successClass))}}var j=this;j.el=a,j.animated=!1,j.options=f(j.defaults,b),j.pointer=0,j.loaderPointer=0;var o=new e(j.el,j.options);j.slides=o.getSlides(),j.container=l(a,j.options.container),j.setSlidesWidth(),j.slides.length>1&&(j.pointer=1,j.loaderPointer=1,j.el.style.left=-j.getContainerWidth()+"px"),j.setSource(),d.call(j),k(window,"resize",g.setScope(j)),k(o.getLeftNav(),"click",function(a){a.preventDefault(),j.goTo("left")}),k(o.getRightNav(),"click",function(a){a.preventDefault(),j.goTo("right")})}function b(a){function b(a){console.log(a),null===r&&(r=a);var d=a-r,g=d/m;g>1&&(g=1);var n=q(g).toFixed(6);c(f,n,i,k),1==g?(g=1,h>1&&(e.pointer===h-1?(e.pointer=1,f.style.left=j(e.getLeftOffset())+"px"):0===e.pointer&&(e.pointer=h-2,f.style.left=j(e.getLeftOffset())+"px")),e.animated=!1,r=null,p(l)):o(b)}var e=this,f=e.el,g=e.getLeftOffset(),h=e.slides.length;if(e.animated)return!1;e.animated=!0;var i=j(f.style.left),k=Math.abs(i-g);"right"===a&&(k=-k);var l,m=e.options.duration,n=1e3/60/m/4,q=d(.445,.05,.55,.95,n),r=null;if(o&&p)l=o(b);else var s=setInterval(function(){null===r&&(r=new Date);var a=new Date-r,b=a/m;b>1&&(b=1);var d=q(b).toFixed(6);c(f,d,i,k),1==b&&(h>1&&(e.pointer===h-1?(e.pointer=1,f.style.left=j(e.getLeftOffset())+"px"):0===e.pointer&&(e.pointer=h-2,f.style.left=j(e.getLeftOffset())+"px")),clearInterval(s),r=null,e.animated=!1)},25)}function c(a,b,c,d){var e=c+d*b;a.style.left=Math.ceil(e)+"px"}function d(a,b,c,d,e){var f=function(b){var d=1-b;return 3*d*d*b*a+3*d*b*b*c+b*b*b},g=function(a){var c=1-a;return 3*c*c*a*b+3*c*a*a*d+a*a*a},h=function(b){var d=1-b;return 3*(2*(b-1)*b+d*d)*a+3*(-b*b*b+2*d*b)*c};return function(a){var b,c,d,i,j,k,l=a;for(d=l,k=0;8>k;k++){if(i=f(d)-l,Math.abs(i)<e)return g(d);if(j=h(d),Math.abs(j)<1e-6)break;d-=i/j}if(b=0,c=1,d=l,b>d)return g(b);if(d>c)return g(c);for(;c>b;){if(i=f(d),Math.abs(i-l)<e)return g(d);l>i?b=d:c=d,d=.5*(c-b)+b}return g(d)}}function e(a,b){var c=this;c.slides=[],c.count=0,c.navigation={left:null,right:null,dots:null},c.createSlideArray(b.selector,a),c.setupWrapper(a),c.count>1&&c.cloningHeadAndTail(a),c.setupNavigation("left"),c.setupNavigation("right"),c.setupElbaIslands()}function f(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function g(a){return"undefined"!=typeof a&&a?a.offsetWidth:window.innerWidth||document.documentElement.clientWidth}function h(a){return"undefined"!=typeof a&&a?a.offsetHeight:window.innerHeight||document.documentElement.clientHeight}function i(a,b){if(a&&b)for(var c=a.length,d=0;c>d&&b(a[d],d)!==!1;d++);}function j(a){return a?parseInt(a,10):0}function k(a,b,c){a.attachEvent?a.attachEvent&&a.attachEvent("on"+b,c):a.addEventListener(b,c,!1)}function l(a,b){for(;a&&a.parentNode;)if(a=a.parentNode,a.className===b)return a;return null}var m=window.classie,n=window.devicePixelRatio>1,o=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame,p=window.cancelAnimationFrame||window.mozCancelAnimationFrame;return a.prototype.defaults={selector:".elba",separator:"|",breakpoints:!1,successClass:"elba-loaded",errorClass:"elba-error",container:"elba-wrapper",src:"data-src",error:!1,success:!1,duration:1e3,easing:null},a.prototype.getContainerWidth=function(){var a=this;return g(a.container)},a.prototype.getContainerHeight=function(){var a=this;return h(a.container)},a.prototype.setSlidesWidth=function(){var a=this,b=a.getContainerWidth(),c=0;a.slides.forEach(function(a){c+=b,a.style.width=b+"px"}),a.el.style.width=c+"px"},a.prototype.setSource=function(){var a=this;a.source=0;var b=0,c=a.getContainerWidth();i(a.options.breakpoints,function(d){return d.width<=c&&Math.abs(c-d.width)<Math.abs(c-b)?(b=d.width,a.source=d.src,!0):void 0})},a.prototype.goTo=function(a){var c=this;if("string"==typeof a){var d=c.slides.length;if("right"===a){if(c.pointer+1>=d)return!1;c.pointer++,b.call(c,"right")}else{if(c.pointer-1<0)return!1;c.pointer--,b.call(c,"left")}}else c.el.style.left=j(c.getLeftOffset())+"px"},a.prototype.getLeftOffset=function(){var a=this;return-(a.getContainerWidth()*a.pointer)},a.prototype.setImageSize=function(a){var b,c,d=this,e=a.naturalHeight/a.naturalWidth,f=d.getContainerWidth(),g=d.getContainerHeight(),h=g/f;h>=e?(a.height=b=Math.ceil(g),a.width=c=Math.ceil(g/e)):(a.height=b=Math.ceil(f*e),a.width=c=Math.ceil(f));var i=(f-c)/2,j=(g-b)/2;a.style.left=Math.ceil(i)+"px",a.style.top=Math.ceil(j)+"px"},e.prototype.createSlideArray=function(a,b){var c=this,d=b||document,e=d.querySelectorAll(a);c.count=e.length;for(var f=c.count;f--;c.slides.unshift(e[f]));},e.prototype.cloningHeadAndTail=function(a){var b=this;if(b.count>1){var c=b.slides[b.count-1].cloneNode(!0);a.insertBefore(c,a.firstChild),b.slides.unshift(c);var d=b.slides[1].cloneNode(!0);a.appendChild(d),b.slides.push(d),b.count+=2}},e.prototype.setupWrapper=function(a){var b=this;b.wrapper=document.createElement("div"),b.wrapper.className="elba-wrapper",b.wrapper.wrap(a)},e.prototype.setupNavigation=function(a){var b=this;b.navigation[a]=document.createElement("a"),b.navigation[a].className="elba-"+a+"-nav",b.navigation[a].innerHtml=a,b.wrapper.appendChild(b.navigation[a])},e.prototype.setupElbaIslands=function(){var a=this;a.slides.forEach(function(a){var b=document.createElement("img");b.className="elba-island",a.appendChild(b)})},e.prototype.getSlides=function(){return this.slides},e.prototype.getLeftNav=function(){return this.navigation.left},e.prototype.getRightNav=function(){return this.navigation.right},a});