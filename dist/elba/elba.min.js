/*! elba - v0.1.0 - 2014-10-09
* https://github.com/dedalodesign/elbajs
* Copyright (c) 2014 ; Licensed  */
!function(a){"use strict";"function"==typeof define&&define.amd?define(a):window.Elba=a()}(function(){"use strict";function a(a){return new RegExp("(^|\\s+)"+a+"(\\s+|$)")}function b(a,b){var c=p(a,b)?r:q;c(a,b)}function c(a,b){function c(a,b){return s.has(a,b)}function d(a){var b=this,e=a||b.loaderPointer,f=b.slides[e],g=b.slides.length;c(f,b.options.successClass)&&g>1&&g-1>e+1&&(e++,d.call(b,e));var h=f.getAttribute(b.source||b.options.src),i=f.querySelector(".elba-island");if(h){var j=h.split(b.options.separator),k=j[t&&j.length>1?1:0],l=new Image;l.onerror=function(){b.options.error&&b.options.error(f,"invalid"),f.className=f.className+" "+b.options.errorClass,g>1&&g-1>e+1&&(e++,d.call(b,e))},l.onload=function(){if(i.src=k,b.setImageSize(i),s.add(f,"no-bg-img"),s.add(f,b.options.successClass),b.options.success&&b.options.success(f),g>1&&(1===e||0===e||e===g-1||e===g-2)){var a,h;a=1===e?b.slides[g-1]:e===g-1?b.slides[1]:0===e?b.slides[g-2]:b.slides[0],c(a,b.options.successClass)||(h=a.querySelector(".elba-island"),h.src=k,b.setImageSize(h),s.add(a,"no-bg-img"),s.add(a,b.options.successClass))}g>1&&g-1>e+1&&(e++,d.call(b,e))},l.src=k}else b.options.error&&b.options.error(f,"missing"),f.className=f.className+" "+b.options.errorClass}function e(){function a(){f.call(b),b._resizeTimeout=null}var b=this;b._resizeTimeout&&clearTimeout(b._resizeTimeout),b._resizeTimeout=setTimeout(a,200)}function f(){var a=this;a.setSlidesWidth(),a.goTo();var b=a.source;if(a.setSource(),b!==a.source)g.call(a),d.call(a);else for(var c=0;c<a.slides.length;c++){var e=a.slides[c];if(e){var f=e.querySelector(".elba-island");a.setImageSize(f)}}}function g(){var a=this,b=a.slides.length;a.loaderPointer=b>1?1:0;for(var c=0;b>c;c++){var d=a.slides[c];d&&(s.remove(d,"no-bg-img"),s.remove(d,a.options.successClass))}}var j=this;j.el=a,j.animated=!1,j.options=i(j.defaults,b),j.pointer=0,j.loaderPointer=0;var k=new h(j.el,j.options);if(j.slides=k.getSlides(),j.container=o(a,j.options.container),j.setSlidesWidth(),j.slides.length>1&&(j.pointer=1,j.loaderPointer=1,j.el.style.left=-j.getContainerWidth()+"px",j.options.navigation&&(n(k.getLeftNav(),"click",function(a){a.preventDefault(),j.goTo("left"),j.options.slideshow&&j.startSlideshow()}),n(k.getRightNav(),"click",function(a){a.preventDefault(),j.goTo("right"),j.options.slideshow&&j.startSlideshow()})),j.options.dots)){j.dots=k.getDots(),s.add(j.dots[j.pointer],"active-dot");for(var l=1;l<j.slides.length-1;l++)j.dots[l].setAttribute("data-target",l),n(j.dots[l],"click",function(a){a.preventDefault(),j.dotTo(this.getAttribute("data-target")),j.options.slideshow&&j.startSlideshow()})}j.setSource(),d.call(j),n(window,"resize",e.setScope(j)),j.options.slideshow&&j.startSlideshow()}function d(a){function b(a){null===p&&(p=a);var f=a-p,g=f/l;g>1&&(g=1);var n=o(g).toFixed(6);e(d,n,i,j),1==g?(g=1,h>1&&(c.pointer===h-1?(c.pointer=1,d.style.left=m(c.getLeftOffset())+"px"):0===c.pointer&&(c.pointer=h-2,d.style.left=m(c.getLeftOffset())+"px")),c.animated=!1,p=null,v(k),c.dots&&c.updateDots()):u(b)}var c=this,d=c.el,g=c.getLeftOffset(),h=c.slides.length;if(c.animated)return!1;c.animated=!0;var i=m(d.style.left),j=Math.abs(i-g);"right"===a&&(j=-j);var k,l=c.options.duration,n=1e3/60/l/4,o=f(w[c.options.easing],n),p=null;if(u&&v)k=u(b);else var q=setInterval(function(){null===p&&(p=new Date);var a=new Date-p,b=a/l;b>1&&(b=1);var f=o(b).toFixed(6);e(d,f,i,j),1==b&&(h>1&&(c.pointer===h-1?(c.pointer=1,d.style.left=m(c.getLeftOffset())+"px"):0===c.pointer&&(c.pointer=h-2,d.style.left=m(c.getLeftOffset())+"px")),clearInterval(q),p=null,c.animated=!1,c.dots&&c.updateDots())},25)}function e(a,b,c,d){var e=c+d*b;a.style.left=Math.ceil(e)+"px"}function f(a,b){return g(a[0],a[1],a[2],a[3],b)}function g(a,b,c,d,e){var f=function(b){var d=1-b;return 3*d*d*b*a+3*d*b*b*c+b*b*b},g=function(a){var c=1-a;return 3*c*c*a*b+3*c*a*a*d+a*a*a},h=function(b){var d=1-b;return 3*(2*(b-1)*b+d*d)*a+3*(-b*b*b+2*d*b)*c};return function(a){var b,c,d,i,j,k,l=a;for(d=l,k=0;8>k;k++){if(i=f(d)-l,Math.abs(i)<e)return g(d);if(j=h(d),Math.abs(j)<1e-6)break;d-=i/j}if(b=0,c=1,d=l,b>d)return g(b);if(d>c)return g(c);for(;c>b;){if(i=f(d),Math.abs(i-l)<e)return g(d);l>i?b=d:c=d,d=.5*(c-b)+b}return g(d)}}function h(a,b){var c=this;c.slides=[],c.count=0,c.navigation={left:null,right:null,dots:null},c.createSlideArray(b.selector,a),c.setupWrapper(a),c.count>1&&(c.cloningHeadAndTail(a),b.navigation&&(c.setupNavigation("left"),c.setupNavigation("right")),b.dots&&c.setupDots(b.dotsContainer)),c.setupElbaIslands()}function i(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function j(a){return"undefined"!=typeof a&&a?a.offsetWidth:window.innerWidth||document.documentElement.clientWidth}function k(a){return"undefined"!=typeof a&&a?a.offsetHeight:window.innerHeight||document.documentElement.clientHeight}function l(a,b){if(a&&b)for(var c=a.length,d=0;c>d&&b(a[d],d)!==!1;d++);}function m(a){return a?parseInt(a,10):0}function n(a,b,c){a.attachEvent?a.attachEvent&&a.attachEvent("on"+b,c):a.addEventListener(b,c,!1)}function o(a,b){for(;a&&a.parentNode;)if(a=a.parentNode,a.className===b)return a;return null}var p,q,r;"classList"in document.documentElement?(p=function(a,b){return a.classList.contains(b)},q=function(a,b){a.classList.add(b)},r=function(a,b){a.classList.remove(b)}):(p=function(b,c){return a(c).test(b.className)},q=function(a,b){p(a,b)||(a.className=a.className+" "+b)},r=function(b,c){b.className=b.className.replace(a(c)," ")});var s={hasClass:p,addClass:q,removeClass:r,toggleClass:b,has:p,add:q,remove:r,toggle:b};window.classie=s,HTMLElement.prototype.wrap=function(a){a.length||(a=[a]);for(var b=a.length-1;b>=0;b--){var c=b>0?this.cloneNode(!0):this,d=a[b],e=d.parentNode,f=d.nextSibling;c.appendChild(d),f?e.insertBefore(c,f):e.appendChild(c)}},Element.prototype.remove=function(){this.parentElement.removeChild(this)},NodeList.prototype.remove=window.HTMLCollection.prototype.remove=function(){for(var a=0,b=this.length;b>a;a++)this[a]&&this[a].parentElement&&this[a].parentElement.removeChild(this[a])},Function.prototype.setScope=function(a){var b=this;return function(){b.apply(a)}};var t=window.devicePixelRatio>1,u=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame,v=window.cancelAnimationFrame||window.mozCancelAnimationFrame,w={easeInSine:[.47,0,.745,.715],easeOutSine:[.39,.575,.565,1],easeInOutSine:[.445,.05,.55,.95],easeInQuad:[.55,.085,.68,.53],easeOutQuad:[.25,.46,.45,.94],easeInOutQuad:[.455,.03,.515,.955],easeInCubic:[.55,.055,.675,.19],easeOutCubic:[.215,.61,.355,1],easeInOutCubic:[.645,.045,.355,1],easeInQuart:[.895,.03,.685,.22],easeOutQuart:[.165,.84,.44,1],easeInOutQuart:[.77,0,.175,1],easeInQuint:[.755,.05,.855,.06],easeOutQuint:[.23,1,.32,1],easeInOutQuint:[.86,0,.07,1],easeInExpo:[.95,.05,.795,.035],easeOutExpo:[.19,1,.22,1],easeInOutExpo:[1,0,0,1],easeInCirc:[.6,.04,.98,.335],easeOutCirc:[.075,.82,.165,1],easeInOutCirc:[.785,.135,.15,.86],easeInBack:[.6,-.28,.735,.045],easeOutBack:[.175,.885,.32,1.275],easeInOutBack:[.68,-.55,.265,1.55]};return c.prototype.defaults={selector:".elba",separator:"|",breakpoints:!1,successClass:"elba-loaded",errorClass:"elba-error",container:"elba-wrapper",src:"data-src",error:!1,success:!1,duration:1e3,easing:"easeInOutCubic",navigation:!0,dots:!0,dotsContainer:!1,slideshow:5e3},c.prototype.getContainerWidth=function(){var a=this;return j(a.container)},c.prototype.getContainerHeight=function(){var a=this;return k(a.container)},c.prototype.setSlidesWidth=function(){var a=this,b=a.getContainerWidth(),c=0;a.slides.forEach(function(a){c+=b,a.style.width=b+"px"}),a.el.style.width=c+"px"},c.prototype.setSource=function(){var a=this;a.source=0;var b=0,c=a.getContainerWidth();l(a.options.breakpoints,function(d){return d.width<=c&&Math.abs(c-d.width)<Math.abs(c-b)?(b=d.width,a.source=d.src,!0):void 0})},c.prototype.goTo=function(a){var b=this;if("string"==typeof a&&isNaN(a)){var c=b.slides.length;if("right"===a){if(b.pointer+1>=c)return!1;b.pointer++,d.call(b,"right")}else{if(b.pointer-1<0)return!1;b.pointer--,d.call(b,"left")}}else if(isNaN(a))b.el.style.left=m(b.getLeftOffset())+"px";else{var e=b.pointer;b.pointer=parseInt(a),b.pointer>e?d.call(b,"right"):d.call(b,"left")}},c.prototype.dotTo=function(a){var b=this;return parseInt(a)===b.pointer?!1:void b.goTo(a)},c.prototype.updateDots=function(){var a=this;a.dots.forEach(function(a){s.remove(a,"active-dot")});var b;b=a.pointer===a.slides.length-1?1:0===a.pointer?a.slides.length-2:a.pointer,s.add(a.dots[b],"active-dot")},c.prototype.getLeftOffset=function(){var a=this;return-(a.getContainerWidth()*a.pointer)},c.prototype.setImageSize=function(a){var b,c,d=this,e=a.naturalHeight/a.naturalWidth,f=d.getContainerWidth(),g=d.getContainerHeight(),h=g/f;h>=e?(a.height=b=Math.ceil(g),a.width=c=Math.ceil(g/e)):(a.height=b=Math.ceil(f*e),a.width=c=Math.ceil(f));var i=(f-c)/2,j=(g-b)/2;a.style.left=Math.ceil(i)+"px",a.style.top=Math.ceil(j)+"px"},c.prototype.startSlideshow=function(){var a=this;a.slides.length>1&&(a.slideshow&&clearInterval(a.slideshow),a.slideshow=setInterval(function(){s.has(a.slides[a.pointer+1],"elba-loaded")&&a.goTo("right")},a.options.slideshow))},c.prototype.clearSlideshow=function(){var a=this;a.slideshow&&clearInterval(a.slideshow)},h.prototype.createSlideArray=function(a,b){var c=this,d=b||document,e=d.querySelectorAll(a);c.count=e.length;for(var f=c.count;f--;c.slides.unshift(e[f]));},h.prototype.cloningHeadAndTail=function(a){var b=this;if(b.count>1){var c=b.slides[b.count-1].cloneNode(!0);a.insertBefore(c,a.firstChild),b.slides.unshift(c);var d=b.slides[1].cloneNode(!0);a.appendChild(d),b.slides.push(d),b.count+=2}},h.prototype.setupWrapper=function(a){var b=this;b.wrapper=document.createElement("div"),b.wrapper.className="elba-wrapper",b.wrapper.wrap(a)},h.prototype.setupNavigation=function(a){var b=this;b.navigation[a]=document.createElement("a"),b.navigation[a].className="elba-"+a+"-nav",b.navigation[a].innerHtml=a,b.wrapper.appendChild(b.navigation[a])},h.prototype.setupDots=function(a){var b=this;b.navigation.dots=[];var c;a?c=document.getElementById(a):(c=document.createElement("div"),c.className="elba-dots-ctr",b.wrapper.appendChild(c));for(var d=1;d<b.count-1;d++)b.navigation.dots[d]=document.createElement("a"),b.navigation.dots[d].className="elba-dot",c.appendChild(b.navigation.dots[d])},h.prototype.setupElbaIslands=function(){var a=this;a.slides.forEach(function(a){var b=document.createElement("img");b.className="elba-island",a.appendChild(b)})},h.prototype.getSlides=function(){return this.slides},h.prototype.getLeftNav=function(){return this.navigation.left},h.prototype.getRightNav=function(){return this.navigation.right},h.prototype.getDots=function(){return this.navigation.dots},c});