/*! elba - v0.3.2 - 2014-12-03
* https://github.com/iliketomatoes/elbajs
* Copyright (c) 2014 ; Licensed  */
!function(a){"use strict";"function"==typeof define&&define.amd?define(a):window.Elba=a()}(function(){"use strict";function a(a){return new RegExp("(^|\\s+)"+a+"(\\s+|$)")}function b(a,b){var c=t(a,b)?v:u;c(a,b)}function c(a,b){function c(a,b,c){if("right"===a.directionHint)a.count>1&&c+1<a.count-1&&Math.abs(c+1-a.pointer)<=b.preload&&(c++,v(a,b,c));else{if(!(a.count>1&&c-1>0&&Math.abs(c-1-a.pointer)<=b.preload))return!1;c--,v(a,b,c)}}if("undefined"==typeof a)throw console.error("missing target"),new Error;this.base={el:a,container:null,slides:[],wrapper:null,count:0,source:0,navigation:{left:null,right:null,dots:null},pointer:0,directionHint:"right",resizeTimout:null,animated:!1},this.defaults={selector:".elba",separator:"|",breakpoints:!1,successClass:"elba-loaded",errorClass:"elba-error",container:"elba-wrapper",src:"data-src",error:!1,success:!1,duration:1e3,easing:"easeInOutCubic",navigation:!0,dots:!0,dotsContainer:!1,slideshow:5e3,preload:1,textLeft:"←",textRight:"→"},this.options=i(this.defaults,b),this.touchHandler={touchEvents:{touchStart:C("PointerDown")+" touchstart",touchEnd:C("PointerUp")+" touchend",touchMove:C("PointerMove")+" touchmove"}};var e=function(a,b){var c=a.el.querySelectorAll(b.selector);a.count=c.length;for(var d=a.count;d--;a.slides.unshift(c[d]));return!0},f=function(a){a.wrapper=document.createElement("div"),a.wrapper.className="elba-wrapper",a.wrapper.wrap(a.el)},g=function(a){if(a.count>1){a.pointer=1;var b=a.slides[a.count-1].cloneNode(!0);a.el.insertBefore(b,a.el.firstChild),a.slides.unshift(b);var c=a.slides[1].cloneNode(!0);a.el.appendChild(c),a.slides.push(c),a.count+=2}a.slides.forEach(function(a){var b=document.createElement("img");b.className="elba-island",a.appendChild(b)})},m=function(a,b,c){var d;a.navigation[c]=document.createElement("a"),a.navigation[c].className="elba-"+c+"-nav","left"===c?(d=document.createTextNode(b.textLeft),a.navigation[c].appendChild(d)):(d=document.createTextNode(b.textRight),a.navigation[c].appendChild(d)),a.wrapper.appendChild(a.navigation[c])},q=function(a,b){a.navigation.dots=[];var c;b?c=document.getElementById(b):(c=document.createElement("div"),c.className="elba-dots-ctr",a.wrapper.appendChild(c));for(var d=1;d<a.count-1;d++)a.navigation.dots[d]=document.createElement("a"),a.navigation.dots[d].className="elba-dot",c.appendChild(a.navigation.dots[d])},s=function(a,b){a.source=0;var c=0,d=j(a.container);l(b.breakpoints,function(b){return b.width<=d&&Math.abs(d-b.width)<Math.abs(d-c)?(c=b.width,a.source=b.src,!0):void 0})},t=function(a){var b=j(a.container),c=0;a.slides.forEach(function(a){c+=b,a.style.width=b+"px"}),a.el.style.width=c+"px"},u=function(a,b){var c,d,e=b.naturalHeight/b.naturalWidth,f=j(a.container),g=k(a.container),h=g/f;h>=e?(b.height=c=Math.ceil(g),b.width=d=Math.ceil(g/e)):(b.height=c=Math.ceil(f*e),b.width=d=Math.ceil(f));var i=(f-d)/2,l=(g-c)/2;b.style.left=Math.ceil(i)+"px",b.style.top=Math.ceil(l)+"px"},v=function(a,b,d){var e=d||a.pointer,f=a.slides[e];if(!f)return!1;(p(f,b.successClass)||p(f,b.errorClass))&&c(a,b,e);var g=f.getAttribute(a.source||b.src),h=f.querySelector(".elba-island");if(g){var i=g.split(b.separator),j=i[x&&i.length>1?1:0],k=new Image;k.onerror=function(){b.error&&b.error(f,"invalid"),f.className=f.className+" "+b.errorClass},k.onload=function(){if(h.src=j,u(a,h),w.add(f,"no-bg-img"),w.add(f,b.successClass),b.success&&b.success(f),a.count>1&&(1===e||0===e||e===a.count-1||e===a.count-2)){var d,g;d=1===e?a.slides[a.count-1]:e===a.count-1?a.slides[1]:0===e?a.slides[a.count-2]:a.slides[0],p(d,b.successClass)||(g=d.querySelector(".elba-island"),g.src=j,u(a,g),w.add(d,"no-bg-img"),w.add(d,b.successClass))}c(a,b,e)},k.src=j}else c(a,b,e),b.error&&b.error(f,"missing"),f.className=f.className+" "+b.errorClass},y=function(a){a.navigation.dots.forEach(function(a){a&&w.remove(a,"active-dot")});var b;b=a.pointer===a.slides.length-1?1:0===a.pointer?a.slides.length-2:a.pointer,a.navigation.dots[b]&&w.add(a.navigation.dots[b],"active-dot")},z=function(a,b){for(var c=a.slides.length,d=0;c>d;d++){var e=a.slides[d];e&&(w.remove(e,"no-bg-img"),w.remove(e,b.successClass))}},A=function(a,b){t(a),h(a.el,n(a.container,a.pointer));var c=a.source;if(s(a,b),c!==a.source)z(a,b),v(a,b);else for(var d=0;d<a.slides.length;d++){var e=a.slides[d];if(e){var f=e.querySelector(".elba-island");u(a,f)}}},B=function(a,b){function c(){A(a,b),a.resizeTimeout=null}a.resizeTimeout&&clearTimeout(a.resizeTimeout),a.resizeTimeout=setTimeout(c,200)};this.init=function(){var a=this;if(e(a.base,a.options),f(a.base),g(a.base),a.base.container=o(a.base.el,a.options.container),a.base.count>1&&(h(a.base.el,-j(a.base.container)),a.options.navigation&&(m(a.base,a.options,"left"),m(a.base,a.options,"right"),a.base.navigation.left.addEventListener("click",function(b){b.preventDefault(),a.goTo("left"),a.options.slideshow&&a.startSlideshow()},!1),a.base.navigation.right.addEventListener("click",function(b){b.preventDefault(),a.goTo("right"),a.options.slideshow&&a.startSlideshow()},!1)),a.options.dots)){q(a.base,a.options.dotsContainer),w.add(a.base.navigation.dots[a.base.pointer],"active-dot");for(var b=function(b){return function(){var c=a.base.navigation.dots[b].getAttribute("data-target");return parseInt(c)===a.base.pointer?!1:(a.goTo(c),a.options.slideshow&&a.startSlideshow(),!1)}},c=1;c<a.base.slides.length-1;c++)a.base.navigation.dots[c].setAttribute("data-target",c),a.base.navigation.dots[c].addEventListener("click",b(c),!1)}if(t(a.base),s(a.base,a.options),v(a.base,a.options),window.addEventListener("resize",function(){B(a.base,a.options)},!1),a.bindTouchEvents(),a.options.slideshow){var d,i;if("undefined"!=typeof document.hidden?(d="hidden",i="visibilitychange"):"undefined"!=typeof document.mozHidden?(d="mozHidden",i="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(d=" msHidden",i="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(d="webkitHidden",i="webkitvisibilitychange"),"undefined"!=typeof document[d]){var k=function(){document[d]?a.clearSlideshow():a.startSlideshow()};document.addEventListener(i,k,!1)}a.startSlideshow()}},this.goTo=function(a){var b=this;if(!b.base.animated){if("string"==typeof a&&isNaN(a)){var c=b.base.slides.length;if("right"===a){if(b.base.pointer+1>=c)return!1;b.base.directionHint="right",b.base.pointer++,v(b.base,b.options),d(b.base,b.options,"right")}else{if(b.base.pointer-1<0)return!1;b.base.directionHint="left",b.base.pointer--,v(b.base,b.options),d(b.base,b.options,"left")}}else if(!isNaN(a)){var e=b.base.pointer;b.base.pointer=parseInt(a),b.base.pointer>e?(b.base.directionHint="right",v(b.base,b.options),d(b.base,b.options,"right")):(b.base.directionHint="left",v(b.base,b.options),d(b.base,b.options,"left"))}b.options.dots&&y(b.base)}},this.bindTouchEvents=function(){var a,b,c,d,e,f=this,g=!1,h=80,i=200,j=0,k=function(a){return a.targetTouches?a.targetTouches[0]:a},l=function(f){"mousedown"===f.type&&f.preventDefault();var h=k(f);c=a=h.pageX,d=b=h.pageY,g=!0,j++,clearTimeout(e),e=setTimeout(function(){j=0},i)},m=function(){var e=[],i=d-b,j=c-a;if(g=!1,-h>=j&&(e.push("swiperight"),f.goTo("left")),j>=h&&(e.push("swipeleft"),f.goTo("right")),-h>=i&&e.push("swipedown"),i>=h&&e.push("swipeup"),e.length)for(var k=0;k<e.length;k++){e[k]}f.options.slideshow&&f.startSlideshow()},n=function(c){var d=k(c);a=d.pageX,b=d.pageY};r(f.base.el,f.touchHandler.touchEvents.touchStart+" mousedown",l),r(f.base.el,f.touchHandler.touchEvents.touchEnd+" mouseup",m),r(f.base.el,f.touchHandler.touchEvents.touchMove+" mousemove",n)},this.init()}function d(a,b,c){function d(b){null===s&&(s=b);var c=b-s,f=c/p;f>1&&(f=1);var i=r(f).toFixed(6);e(g,i,k,l),1===f?(j>1&&(a.pointer===j-1?(a.pointer=1,h(g,n(a.container,a.pointer))):0===a.pointer&&(a.pointer=j-2,h(g,n(a.container,a.pointer)))),A(o),s=null,a.animated=!1):z(d)}var g=a.el;if(a.animated)return!1;a.animated=!0;var i=n(a.container,a.pointer),j=a.slides.length,k=m(h(g)),l=Math.abs(k-i);"right"===c&&(l=-l);var o,p=b.duration,q=1e3/60/p/8,r=f(D[b.easing],q),s=null;if(z&&A)o=z(d);else var t=setInterval(function(){null===s&&(s=new Date);var b=new Date-s,c=b/p;c>1&&(c=1);var d=r(c).toFixed(6);e(g,d,k,l),1===c&&(j>1&&(a.pointer===j-1?(a.pointer=1,h(g,n(a.container,a.pointer))):0===a.pointer&&(a.pointer=j-2,h(g,n(a.container,a.pointer)))),clearInterval(t),s=null,a.animated=!1)},25)}function e(a,b,c,d){h(a,Math.ceil(c+d*b))}function f(a,b){return g(a[0],a[1],a[2],a[3],b)}function g(a,b,c,d,e){var f=function(b){var d=1-b;return 3*d*d*b*a+3*d*b*b*c+b*b*b},g=function(a){var c=1-a;return 3*c*c*a*b+3*c*a*a*d+a*a*a},h=function(b){var d=1-b;return 3*(2*(b-1)*b+d*d)*a+3*(-b*b*b+2*d*b)*c};return function(a){var b,c,d,i,j,k,l=a;for(d=l,k=0;8>k;k++){if(i=f(d)-l,Math.abs(i)<e)return g(d);if(j=h(d),Math.abs(j)<1e-6)break;d-=i/j}if(b=0,c=1,d=l,b>d)return g(b);if(d>c)return g(c);for(;c>b;){if(i=f(d),Math.abs(i-l)<e)return g(d);l>i?b=d:c=d,d=.5*(c-b)+b}return g(d)}}function h(a,b){if("undefined"==typeof b){if(y){var c=a.style[y].match(/-?\d+/g)[0];return c}return a.style.left}y?a.style[y]="translate("+b+"px, 0px)":a.style.left=b+"px"}function i(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function j(a){return"undefined"!=typeof a&&a?a.offsetWidth:window.innerWidth||document.documentElement.clientWidth}function k(a){return"undefined"!=typeof a&&a?a.offsetHeight:window.innerHeight||document.documentElement.clientHeight}function l(a,b){if(a&&b)for(var c=a.length,d=0;c>d&&b(a[d],d)!==!1;d++);}function m(a){return a?parseInt(a,10):0}function n(a,b){return m(-(j(a)*b))}function o(a,b){for(;a&&a.parentNode;)if(a=a.parentNode,a.className===b)return a;return null}function p(a,b){return w.has(a,b)}function q(a){"function"==typeof jQuery&&a instanceof jQuery&&(a=a[0]);var b=a.getBoundingClientRect();return b.top>=0&&b.left>=0&&b.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&b.right<=(window.innerWidth||document.documentElement.clientWidth)}function r(a,b,c){for(var d=b.split(" "),e=d.length;e--;)a.addEventListener(d[e],c,!1)}function s(){for(var a="transform WebkitTransform MozTransform OTransform msTransform".split(" "),b=0;b<a.length;b++)if(void 0!==document.createElement("div").style[a[b]])return a[b];return!1}var t,u,v;"classList"in document.documentElement?(t=function(a,b){return a.classList.contains(b)},u=function(a,b){a.classList.add(b)},v=function(a,b){a.classList.remove(b)}):(t=function(b,c){return a(c).test(b.className)},u=function(a,b){t(a,b)||(a.className=a.className+" "+b)},v=function(b,c){b.className=b.className.replace(a(c)," ")});var w={hasClass:t,addClass:u,removeClass:v,toggleClass:b,has:t,add:u,remove:v,toggle:b};window.classie=w,HTMLElement.prototype.wrap=function(a){a.length||(a=[a]);for(var b=a.length-1;b>=0;b--){var c=b>0?this.cloneNode(!0):this,d=a[b],e=d.parentNode,f=d.nextSibling;c.appendChild(d),f?e.insertBefore(c,f):e.appendChild(c)}},Element.prototype.remove=function(){this.parentElement.removeChild(this)},NodeList.prototype.remove=window.HTMLCollection.prototype.remove=function(){for(var a=0,b=this.length;b>a;a++)this[a]&&this[a].parentElement&&this[a].parentElement.removeChild(this[a])};var x=window.devicePixelRatio>1,y=s(),z=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame,A=window.cancelAnimationFrame||window.mozCancelAnimationFrame,B=!!navigator.pointerEnabled||navigator.msPointerEnabled,C=(!!("ontouchstart"in window)&&navigator.userAgent.indexOf("PhantomJS")<0||B,function(a){var b=a.toLowerCase(),c="MS"+a;return navigator.msPointerEnabled?c:b}),D={easeInSine:[.47,0,.745,.715],easeOutSine:[.39,.575,.565,1],easeInOutSine:[.445,.05,.55,.95],easeInQuad:[.55,.085,.68,.53],easeOutQuad:[.25,.46,.45,.94],easeInOutQuad:[.455,.03,.515,.955],easeInCubic:[.55,.055,.675,.19],easeOutCubic:[.215,.61,.355,1],easeInOutCubic:[.645,.045,.355,1],easeInQuart:[.895,.03,.685,.22],easeOutQuart:[.165,.84,.44,1],easeInOutQuart:[.77,0,.175,1],easeInQuint:[.755,.05,.855,.06],easeOutQuint:[.23,1,.32,1],easeInOutQuint:[.86,0,.07,1],easeInExpo:[.95,.05,.795,.035],easeOutExpo:[.19,1,.22,1],easeInOutExpo:[1,0,0,1],easeInCirc:[.6,.04,.98,.335],easeOutCirc:[.075,.82,.165,1],easeInOutCirc:[.785,.135,.15,.86],easeInBack:[.6,-.28,.735,.045],easeOutBack:[.175,.885,.32,1.275],easeInOutBack:[.68,-.55,.265,1.55]};return c.prototype.startSlideshow=function(){var a=this;a.base.slides.length>1&&(a.slideshow&&clearInterval(a.slideshow),a.slideshow=setInterval(function(){if(!q(a.base.container))return!1;var b=a.base.slides[a.base.pointer+1];b&&(w.has(b,a.options.successClass)||w.has(b,a.options.errorClass))&&a.goTo("right")},a.options.slideshow))},c.prototype.clearSlideshow=function(){var a=this;a.slideshow&&clearInterval(a.slideshow)},c.prototype.stopSlideshow=function(){var a=this;a.slideshow&&clearInterval(a.slideshow),a.options.slideshow=0},c.prototype.getCurrent=function(){return this.base.pointer},c});